<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ê¸°ìš”ê¸ˆ ê³„ì‚°ê¸° & ëˆ„ì§„ì„¸ ë¶„ì„ê¸°</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f4f7f6; padding: 20px; color: #333; }
        .container { max-width: 600px; margin: 0 auto; background-color: #ffffff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        h2 { color: #16a085; border-bottom: 3px solid #1abc9c; padding-bottom: 10px; margin-bottom: 25px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 16px; }
        button.main-btn { width: 100%; background-color: #1abc9c; color: white; padding: 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; font-weight: bold; transition: 0.3s; }
        button.main-btn:hover { background-color: #16a085; }
        
        /* ê²°ê³¼ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .result-box { display: none; margin-top: 30px; padding: 20px; border-radius: 10px; background-color: #f9f9f9; border-left: 6px solid #e74c3c; line-height: 1.6; }
        .result-box h3 { color: #e74c3c; margin-top: 0; }
        .level-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; color: white; font-weight: bold; margin-left: 5px; }

        /* [ì¶”ê°€] ëˆ„ì§„ì„¸ ê¸°ì¤€í‘œ ìŠ¤íƒ€ì¼ */
        .table-title { font-size: 14px; font-weight: bold; margin-top: 20px; margin-bottom: 10px; color: #16a085; }
        .rate-table { width: 100%; border-collapse: collapse; font-size: 12px; text-align: center; background: white; border: 1px solid #ddd; }
        .rate-table th { background: #f2f2f2; padding: 8px; border: 1px solid #ddd; }
        .rate-table td { padding: 8px; border: 1px solid #ddd; }
        .active-row { background-color: #fff4f4; font-weight: bold; border: 2px solid #e74c3c !important; }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); }
        .modal-content { background-color: #fff; margin: 10% auto; padding: 25px; border-radius: 15px; width: 85%; max-width: 450px; position: relative; }
        .close-btn { float: right; font-size: 24px; font-weight: bold; cursor: pointer; color: #aaa; }
    </style>
</head>
<body>

<div class="container">
    <h2>âš¡ï¸ ì „ê¸°ìš”ê¸ˆ ê³„ì‚°ê¸°</h2>

    <div class="input-group">
        <label for="usage">ì›”ê°„ ì‚¬ìš©ëŸ‰ (kWh)</label>
        <input type="number" id="usage" value="350" placeholder="ì˜ˆ: 350">
        <div style="text-align: right; margin-top: 8px;">
            <button type="button" onclick="openModal()" style="background:none; border:none; color:#3498db; cursor:pointer; text-decoration:underline; font-size:13px;">
                ğŸ’¡ ë‚´ ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ëŠ” ë²•
            </button>
        </div>
    </div>

    <div class="input-group">
        <label for="type">ì£¼ê±° ë°©ì‹</label>
        <select id="type" onchange="updateRateTable()">
            <option value="low">ì£¼íƒìš© ì €ì•• (ë‹¨ë…ì£¼íƒ ë“±)</option>
            <option value="high">ì£¼íƒìš© ê³ ì•• (ì•„íŒŒíŠ¸ ë“±)</option>
        </select>
    </div>

    <button class="main-btn" onclick="calculate()">ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>

    <div id="results" class="result-box">
        <h3>ğŸ’° ì´ ì˜ˆìƒ ìš”ê¸ˆ: <span id="totalFee">0</span>ì›</h3>
        <p id="analysisText"></p>
        <div id="detailText" style="font-size: 0.85em; color: #666; margin-bottom: 15px;"></div>

        <div class="table-title">ğŸ“Œ ì ìš©ëœ ëˆ„ì§„ì œ ê¸°ì¤€ (í˜„í–‰)</div>
        <table class="rate-table">
            <thead>
                <tr>
                    <th>ë‹¨ê³„</th>
                    <th>êµ¬ê°„ (kWh)</th>
                    <th>ê¸°ë³¸ìš”ê¸ˆ</th>
                    <th>ë‹¨ê°€ (ì›)</th>
                </tr>
            </thead>
            <tbody id="rate-table-body">
                </tbody>
        </table>
    </div>
</div>

<div id="guideModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <h3>ğŸ”Œ ì‚¬ìš©ëŸ‰ í™•ì¸ ê°€ì´ë“œ</h3>
        <p style="font-size:14px; color:#666;">ê³„ëŸ‰ê¸° '07ë²ˆ' í•­ëª© ë˜ëŠ” ì•„íŒŒíŠ¸ ì›”íŒ¨ë“œ ë©”ë‰´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
        <button onclick="closeModal()" style="width:100%; padding:10px; background:#3498db; color:white; border:none; border-radius:5px; cursor:pointer; margin-top:10px;">ë‹«ê¸°</button>
    </div>
</div>

<script>
    const FEE_DATA = {
        low: {
            name: "ì£¼íƒìš© ì €ì••",
            basic: [910, 1600, 7300],
            unit: [93.3, 187.9, 280.6]
        },
        high: {
            name: "ì£¼íƒìš© ê³ ì••",
            basic: [730, 1260, 6060],
            unit: [78.3, 147.3, 215.6]
        }
    };

    function calculate() {
        const usage = parseFloat(document.getElementById('usage').value);
        const type = document.getElementById('type').value;
        const data = FEE_DATA[type];

        if (!usage || usage < 0) { alert("ì‚¬ìš©ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }

        let basicFee = 0, usageFee = 0, level = 1;

        if (usage <= 200) {
            basicFee = data.basic[0]; usageFee = usage * data.unit[0]; level = 1;
        } else if (usage <= 400) {
            basicFee = data.basic[1]; usageFee = (200 * data.unit[0]) + ((usage - 200) * data.unit[1]); level = 2;
        } else {
            basicFee = data.basic[2]; usageFee = (200 * data.unit[0]) + (200 * data.unit[1]) + ((usage - 400) * data.unit[2]); level = 3;
        }

        const preTax = basicFee + usageFee + (usage * 9) + (usage * 5); // í™˜ê²½ìš”ê¸ˆ ë“± ê°€ì‚°
        const total = Math.floor((preTax * 1.137) / 10) * 10;

        document.getElementById('totalFee').innerText = total.toLocaleString();
        
        const colors = ["#2ecc71", "#f39c12", "#e74c3c"];
        document.getElementById('analysisText').innerHTML = `í˜„ì¬ ê³ ê°ë‹˜ì€ <span class="level-badge" style="background:${colors[level-1]}">${level}ë‹¨ê³„</span> êµ¬ê°„ì…ë‹ˆë‹¤.`;
        document.getElementById('detailText').innerText = `(*ê¸°ë³¸ë£Œ, ì „ë ¥ëŸ‰ìš”ê¸ˆ, í™˜ê²½ìš”ê¸ˆ, ì—°ë£Œë¹„ì¡°ì •ì•¡, ì„¸ê¸ˆ í¬í•¨ ë‚´ì—­)`;
        
        updateRateTable(level); // í…Œì´ë¸” ì—…ë°ì´íŠ¸ ì‹œ í˜„ì¬ ë‹¨ê³„ í•˜ì´ë¼ì´íŠ¸
        document.getElementById('results').style.display = 'block';
    }

    function updateRateTable(activeLevel = 0) {
        const type = document.getElementById('type').value;
        const data = FEE_DATA[type];
        const tbody = document.getElementById('rate-table-body');
        
        const ranges = ["200 ì´í•˜", "201 ~ 400", "400 ì´ˆê³¼"];
        let html = '';
        
        for(let i=0; i<3; i++) {
            const isTarget = (activeLevel === i + 1) ? 'class="active-row"' : '';
            html += `<tr ${isTarget}>
                <td>${i+1}ë‹¨ê³„</td>
                <td>${ranges[i]}</td>
                <td>${data.basic[i].toLocaleString()}ì›</td>
                <td>${data.unit[i]}ì›</td>
            </tr>`;
        }
        tbody.innerHTML = html;
    }

    // ì´ˆê¸° í…Œì´ë¸” ì„¸íŒ…
    updateRateTable();

    // ëª¨ë‹¬ í•¨ìˆ˜
    function openModal() { document.getElementById('guideModal').style.display = 'block'; }
    function closeModal() { document.getElementById('guideModal').style.display = 'none'; }
</script>

</body>
</html>
